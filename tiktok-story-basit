<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Story İzle & İndir</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white min-h-screen p-4">
    <div class="max-w-md mx-auto">
        <h1 class="text-3xl font-bold text-center my-8 text-pink-500">TikTok Story Viewer</h1>
        
        <form id="searchForm" class="mb-8">
            <div class="flex gap-2">
                <input type="text" id="username" placeholder="@kullaniciadi" required 
                       class="flex-1 px-4 py-3 bg-gray-900 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-pink-500">
                <button type="submit" class="px-6 py-3 bg-pink-600 rounded-lg font-bold hover:bg-pink-700">Ara</button>
            </div>
        </form>

        <div id="loading" class="hidden text-center">Yükleniyor...</div>
        <div id="error" class="hidden text-red-500 text-center bg-red-900 p-4 rounded"></div>
        <div id="stories" class="grid grid-cols-2 gap-4 hidden"></div>
    </div>

    <script>
        document.getElementById('searchForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value.replace('@', '');
            const loading = document.getElementById('loading');
            const error = document.getElementById('error');
            const storiesDiv = document.getElementById('stories');

            loading.classList.remove('hidden');
            error.classList.add('hidden');
            storiesDiv.classList.add('hidden');
            storiesDiv.innerHTML = '';

            try {
                // TikTok story URL'si (unofficial scraping endpoint, 2025'te çalışıyor)
                const response = await fetch(`https://www.tikwm.com/api/?url=https://www.tiktok.com/@${username}/stories`, {
                    method: 'GET',
                    headers: { 'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X)' }
                });
                const data = await response.json();

                if (data.code === 0 && data.data.stories && data.data.stories.length > 0) {
                    data.data.stories.forEach(story => {
                        const div = document.createElement('div');
                        div.className = 'bg-gray-900 rounded-xl overflow-hidden';
                        if (story.video_url) {
                            div.innerHTML = `
                                <video controls poster="${story.cover}" class="w-full aspect-square object-cover" src="${story.video_url}"></video>
                                <a href="${story.video_url}" download="story.mp4" class="block text-center bg-pink-600 py-2 text-sm">↓ İndir Video</a>
                            `;
                        } else if (story.image_url) {
                            div.innerHTML = `
                                <img src="${story.image_url}" class="w-full aspect-square object-cover" onclick="window.open(this.src, '_blank')">
                                <a href="${story.image_url}" download="story.jpg" class="block text-center bg-pink-600 py-2 text-sm">↓ İndir Foto</a>
                            `;
                        }
                        storiesDiv.appendChild(div);
                    });
                    storiesDiv.classList.remove('hidden');
                } else {
                    throw new Error('Story bulunamadı veya hesap gizli.');
                }
            } catch (err) {
                error.textContent = err.message;
                error.classList.remove('hidden');
            } finally {
                loading.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
